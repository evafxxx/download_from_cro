var dnld='<svg enable-background="new 0 0 64 64" version="1.1" viewBox="0 0 64 64" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" >'+
'<style type="text/css">	.st0{fill:#C75C5C;}.st1{opacity:0.2;}.st2{fill:#231F20;}.st3{fill:#FFFFFF;}.st4{fill:#8C81D4;}</style>'+
'<circle class="st0" cx="32" cy="32" r="32"/>	'+
'<g class="st1"><path class="st2" d="m40 11.2v0 0z"/><path class="st2" d="m24 11.1v0 0z"/></g>'+
'<g class="st1">	<path class="st2" d="m48 32c0-6.5-3.8-12-9.4-14.5-1.7-0.8-2.6 0.5-2.6 1.6v8.5c0 0.8 0.7 1.4 1.5 1.4h3.1c1.5 0 1.9 1.1 0.9 2.4l-7.7 9.8c-1 1.2-2.6 1.2-3.5 0l-7.7-9.8c-1-1.2-0.6-2.4 0.9-2.4h3.1c0.8 0 1.5-0.6 1.5-1.4v-8.5c0-1.1-1.5-2.1-2.8-1.6-4.3 2-7.6 5.9-8.7 10.6-4.9 0.8-8.6 4.9-8.6 9.9 0 5.5 4.5 10 10 10h30c4.4 0 8-3.6 8-8s-3.6-8-8-8z"/></g>'+
'<path class="st3" d="m48 30c0-6.5-3.8-12-9.4-14.5-1.7-0.8-2.6 0.5-2.6 1.6v8.5c0 0.8 0.7 1.4 1.5 1.4h3.1c1.5 0 1.9 1.1 0.9 2.4l-7.7 9.8c-1 1.2-2.6 1.2-3.5 0l-7.7-9.8c-1-1.2-0.6-2.4 0.9-2.4h3.1c0.8 0 1.5-0.6 1.5-1.4v-8.5c0-1.1-1.5-2.1-2.8-1.6-4.3 2-7.6 5.9-8.7 10.6-4.9 0.8-8.6 4.9-8.6 9.9 0 5.5 4.5 10 10 10h30c4.4 0 8-3.6 8-8s-3.6-8-8-8z"/>'+
'<path class="st4" d="m40 9.2v0 0z"/>'+
'<path class="st4" d="m24 9.1v0 0z"/>'+
'<g fill="#fff"><path d="m18.527 14.294q-0.36488-1.1658-1.1755-3.4491-0.804-2.286-1.2645-3.4208 0.56944-0.21562 0.92114-0.35834 0.40479-0.16426 0.87056-0.36872l0.38046 1.0899q0.08579-0.39806 0.18023-0.66051 0.09839-0.27178 0.30977-0.55078 0.21139-0.279 0.5453-0.5227 0.33786-0.25303 0.73601-0.4146 0.29862-0.12118 0.60156-0.17455 0.30025-0.060011 0.56896-0.045393 0.27265 0.00529 0.48577 0.073381 0.21975 0.065398 0.39989 0.18552 0.17744 0.11348 0.43941 0.37815 0.05174-0.2915 0.10925-0.4926 0.06145-0.21043 0.19985-0.4598 0.13839-0.24938 0.34478-0.46451t0.49404-0.40142q0.2916-0.19561 0.63003-0.33295 0.57732-0.23428 1.1664-0.24918 0.58636-0.021542 1.0453 0.2714 0.45624 0.28631 0.70129 0.89018 0.12926 0.31852 0.33324 0.95451t0.70581 2.0631q0.49913 1.4205 0.80217 2.1863-0.48981 0.1833-0.86142 0.3341-0.43797 0.17773-1.0232 0.43066-0.28765-0.88027-0.61425-1.8375l-0.53703-1.5519q-0.2011-0.59079-0.36266-0.98894-0.19119-0.47115-0.44076-0.64811-0.24562-0.18629-0.51827-0.19158-0.26871-0.014619-0.55405 0.10117-0.29862 0.12118-0.49837 0.33362-0.19312 0.20975-0.30314 0.54809-0.10339 0.33564-0.07886 0.71985 0.02183 0.37757 0.21648 1.0096 0.19196 0.62541 0.56001 1.6276l0.70215 1.8636q-0.55617 0.21023-0.92114 0.35834-0.36498 0.14811-0.97009 0.40912-0.1609-0.52982-0.71552-2.1442-0.55462-1.6144-0.77813-2.1651-0.11848-0.29198-0.24572-0.47221-0.12993-0.18686-0.34862-0.30679-0.21475-0.12926-0.4422-0.13743-0.22745-0.00818-0.47961 0.094152-0.46451 0.1885-0.69235 0.63647-0.22783 0.44797-0.18638 1.0263 0.04809 0.57559 0.57559 2.085 0.53145 1.5001 0.88421 2.3694-0.61589 0.23447-0.92778 0.36103-0.3517 0.14272-0.97009 0.40912z"/><path d="m30.417 13.45q0.44083-1.957 1.0019-5.0901 0.56109-3.1331 0.82256-5.0995 1.3809-0.062018 2.1296-0.041938t1.4799 0.11731q0.95836 0.12743 1.7232 0.46032 0.77198 0.33383 1.1768 0.9295 0.41194 0.59661 0.54566 1.3296 0.14082 0.73395 0.03887 1.5006-0.10289 0.77379-0.4183 1.4615t-0.8462 1.2023q-0.52985 0.50751-1.1682 0.68994-0.6303 0.17627-1.3402 0.08188-0.41884-0.05569-0.81737-0.20983-0.39143-0.15319-0.68207-0.358-0.28355-0.20387-0.46061-0.39357-0.17612-0.19681-0.43701-0.57105l-0.5171 3.0739-0.07129 0.48179q-0.01937 0.09134-0.10149 0.70896-0.65216-0.09394-1.0071-0.14114zm3.6101-8.6229q-0.10066 0.37674-0.15878 0.65077l-0.14737 0.78232q-0.09636 0.50735-0.12845 0.74872-0.05758 0.43304-0.02525 0.84191 0.03943 0.40981 0.25772 0.77839 0.2254 0.36952 0.56385 0.59514 0.34649 0.21946 0.73694 0.27138 0.53952 0.071739 1.0203-0.17499 0.48877-0.25289 0.80942-0.81711 0.32066-0.56422 0.41033-1.2386 0.099113-0.74539-0.10268-1.2924-0.19376-0.55315-0.60984-0.84689-0.41609-0.29373-0.98401-0.36925-0.7383-0.098169-1.6421 0.070631z"/><path d="m40.336 11.677q0.46263-0.85898 0.76175-1.5075 0.98572 1.2392 2.0645 1.9048 0.53635 0.3309 1.0744 0.42722 0.54412 0.10008 0.98954-0.06269 0.45528-0.1651 0.72225-0.59784 0.22561-0.36569 0.1815-0.77157-0.03426-0.40821-0.40255-0.82056-0.35844-0.41468-1.0654-0.85086-0.45102-0.27826-0.96636-0.52046 0.49337-0.66331 0.91724-1.2685 0.322 0.2828 0.6694 0.49713 0.53635 0.3309 1.0818 0.52434 0.55151 0.1972 1.0152 0.04572 0.46746-0.15758 0.7006-0.53546 0.094-0.15237 0.13173-0.32264 0.04758-0.1726 0.0337-0.34104-4e-3 -0.17078-0.07562-0.34117-0.065495-0.16662-0.18402-0.31548-0.11477-0.15495-0.35429-0.35321-0.23952-0.19826-0.53817-0.38251-0.40226-0.24817-0.86884-0.4603-0.45672-0.21446-1.2113-0.47804l0.4279-0.43443 0.63887-0.70818q0.76107 0.33491 1.2651 0.59539 0.50406 0.26049 1.0648 0.60643 0.63996 0.39482 1.1733 0.86694 0.53947 0.47587 0.80818 0.99507 0.26871 0.5192 0.21791 1.0516-0.04471 0.5362-0.34553 1.0238-0.19553 0.31693-0.47872 0.57137-0.27943 0.24834-0.62397 0.39761-0.33844 0.15303-0.66924 0.18456-0.3247 0.03529-0.60195 0.0073t-0.77209-0.13975q0.39747 0.33778 0.57643 0.566 0.18272 0.22212 0.30295 0.53191 0.12398 0.30369 0.14332 0.62697 0.0231 0.31718-0.07816 0.65862-0.0975 0.33534-0.29303 0.65228-0.35346 0.57292-0.94359 0.91568-0.58027 0.34042-1.3051 0.35602-0.71878 0.01936-1.4598-0.25266-0.74473-0.26592-1.4578-0.70587-0.52416-0.32338-1.0435-0.73636-0.51937-0.41298-1.2233-1.0997z"/></g><circle transform="rotate(230.41)" cx="-45.053" cy="4.2701" r="21.467" fill="none" stop-color="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.0405" style="paint-order:stroke fill markers"/><circle transform="matrix(-.66668 .74534 .74534 .66668 0 0)" cx="2.2498" cy="45.401" r="30.454" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width=".89097" style="paint-order:stroke fill markers"/></svg>';

var mrp = jQuery('div.mujRozhlasPlayer');
var mrpm = jQuery('div.mujRozhlasPlayer div.mrp-holder__media');


function force_download(blob, filename) {
  var a = document.createElement('a');
  a.download = filename;
  a.href = blob;
  // For Firefox https://stackoverflow.com/a/32226068
  document.body.appendChild(a);
  a.click();
  a.remove();
}

function download_resource(url, filename) {
  if (!filename) filename = url.split('\\').pop().split('/').pop();
  fetch(url, {
      headers: new Headers({
        'Origin': location.origin
      }),
      mode: 'cors'
    })
    .then(response => response.blob())
    .then(blob => {
      let blobUrl = window.URL.createObjectURL(blob);
      force_download(blobUrl, filename);
    })
    .catch(e => console.error(e));
}

function download_mp3(){
    if (mrp.length && typeof jQuery('div.mujRozhlasPlayer').attr('data-player') !== 'undefined') {
    
        try {
          var dp=JSON.parse(jQuery('div.mujRozhlasPlayer').attr('data-player')) ;    
          var _playlist = dp['data']['playlist']; 
          for (var i=0;i<_playlist.length;i++)  {
              var _audiolinks = _playlist[i]['audioLinks'];
              for (var j=0;j<_audiolinks.length;j++)  {
                  
                  var href = _audiolinks[j]['url'];
                  var suffix = _playlist[i]['part'] ==1 ? '' :'_'+j;
                  var name = _playlist[i]['title'] + suffix +  _audiolinks[j]['variant'];
                  download_resource(href,name);
              }    
          }
        
        }          
        catch(err) {
        
        }
    } 
}
mrpm.append('<div id="dnld_mp3" style="width:50px;height:50px;float:right;position: absolute;right: 0em;top: 20px;" onclick="download_mp3();">'+dnld+'</div>');
    
